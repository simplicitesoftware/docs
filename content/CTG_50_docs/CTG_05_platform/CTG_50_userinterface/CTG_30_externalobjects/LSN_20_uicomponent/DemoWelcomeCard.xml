<?xml version="1.0" encoding="UTF-8"?>
<simplicite xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.simplicite.fr/base" xsi:schemaLocation="http://www.simplicite.fr/base https://www.simplicite.io/resources/schemas/base.xsd">
<object>
	<name>ObjectExternal</name>
	<action>upsert</action>
	<data>
		<obe_name>DemoWelcomeCard</obe_name>
		<obe_type>E</obe_type>
		<obe_nature>com_simplicite_webapp_web_ResponsiveExternalObject</obe_nature>
		<obe_url/>
		<obe_settings/>
		<obe_comment/>
		<obe_help/>
		<obe_class>com.simplicite.webapp.web.ResponsiveExternalObject</obe_class>
		<obe_script_id/>
		<obe_icon/>
		<obe_permalink/>
		<obe_widget>1</obe_widget>
		<row_module_id.mdl_name>Demo</row_module_id.mdl_name>
	</data>
</object>
<object>
	<name>Permission</name>
	<action>upsert</action>
	<data>
		<prm_group_id.grp_name>DEMO_ADMIN</prm_group_id.grp_name>
		<prm_object>
			<object>
				<name>ObjectExternal</name>
				<data>
					<obe_name>DemoWelcomeCard</obe_name>
				</data>
			</object>
		</prm_object>
		<prm_perm>1</prm_perm>
		<prm_upd>0</prm_upd>
		<prm_req>0</prm_req>
		<prm_prop/>
		<prm_value/>
		<row_module_id.mdl_name>Demo</row_module_id.mdl_name>
	</data>
</object>
<object>
	<name>Permission</name>
	<action>upsert</action>
	<data>
		<prm_group_id.grp_name>DEMO_PUBLIC</prm_group_id.grp_name>
		<prm_object>
			<object>
				<name>ObjectExternal</name>
				<data>
					<obe_name>DemoWelcomeCard</obe_name>
				</data>
			</object>
		</prm_object>
		<prm_perm>1</prm_perm>
		<prm_upd>0</prm_upd>
		<prm_req>0</prm_req>
		<prm_prop/>
		<prm_value/>
		<row_module_id.mdl_name>Demo</row_module_id.mdl_name>
	</data>
</object>
<object>
	<name>Permission</name>
	<action>upsert</action>
	<data>
		<prm_group_id.grp_name>DEMO_USER</prm_group_id.grp_name>
		<prm_object>
			<object>
				<name>ObjectExternal</name>
				<data>
					<obe_name>DemoWelcomeCard</obe_name>
				</data>
			</object>
		</prm_object>
		<prm_perm>1</prm_perm>
		<prm_upd>0</prm_upd>
		<prm_req>0</prm_req>
		<prm_prop/>
		<prm_value/>
		<row_module_id.mdl_name>Demo</row_module_id.mdl_name>
	</data>
</object>
<object>
	<name>Permission</name>
	<action>upsert</action>
	<data>
		<prm_group_id.grp_name>DEMO_WEBSITE</prm_group_id.grp_name>
		<prm_object>
			<object>
				<name>ObjectExternal</name>
				<data>
					<obe_name>DemoWelcomeCard</obe_name>
				</data>
			</object>
		</prm_object>
		<prm_perm>1</prm_perm>
		<prm_upd>0</prm_upd>
		<prm_req>0</prm_req>
		<prm_prop/>
		<prm_value/>
		<row_module_id.mdl_name>Demo</row_module_id.mdl_name>
	</data>
</object>
<object>
	<name>Resource</name>
	<action>upsert</action>
	<data>
		<res_object>
			<object>
				<name>ObjectExternal</name>
				<data>
					<obe_name>DemoWelcomeCard</obe_name>
				</data>
			</object>
		</res_object>
		<res_type>CSS</res_type>
		<res_lang>ANY</res_lang>
		<res_code>STYLES</res_code>
		<res_cached>0</res_cached>
		<res_file><![CDATA[DATA:DemoWelcomeCard.less:#demowelcomecard {
    display: flex;
    flex-direction: column;
}

#demowelcomecard-header {
    display: flex;
    flex-direction: column;
    text-align: left;
    gap: 4px;
    width: 100%;

    & h1 { 
        font-size: 32px;
        font-weight: 600;
    }
    & h3 {
        font-size: 24px;
    }
}

#demowelcomecard-actions {
    display: flex;
    flex-direction: row;
    justify-content: start;
    align-items: center;

    box-sizing: border-box;
    margin-top: 32px;
    gap: 32px;

    & .demowelcomecard-btn {
        position: relative;
        font-size: 24px;
        font-weight: 600;
        padding: 16px 32px;
        border: none;

        &::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            border-left: solid 4px transparent;
            transition: all 0.33s ease-in;
        }

        &:hover {
            &::before {
                border-left-width: 16px;
            }
        }
        &:active {
            &::before {
                border-left-width: 64px;
            }
        }
    }

    & #tutorial {
        background-color: rgba(84, 81, 255, 0.1);
        color: #5451FF;

        &::before {
            border-color: #5451FF;
        }
    }
    & #products {
        background-color: rgba(255, 209, 102, 0.1);
        color: #FFD166;

        &::before {
            border-color: #FFD166;
        }
    }
    & #user-infos {
        background-color: rgba(88, 236, 155, 0.1);
        color: #58EC9B;

        &::before {
            border-color: #58EC9B;
        }
    }
}

#demowelcomecard-productlist {
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: start;
    align-items: center;

    box-sizing: border-box;
    margin-top: 16px;
    padding: 32px;
    gap: 16px;

    & .demowelcomecard-product-card {
        position: relative;
        display: flex;
        flex-direction: row;
        box-sizing: border-box;
        padding: 16px;
        width: 40vw; /* fix this later on */
        border: solid 1px #C6C6C6;
        background: rgba(198, 198, 198, 0.25);

        & .dwc-product-card-left {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            width: 50%;
            text-align: left;

            & .dwc-product-card-left-header {
                display: flex;
                flex-direction: column;

                & .dwc-product-card-left-header-title {
                    font-size: 32px;
                    font-weight: 600;
                }
                & .dwc-product-card-left-header-subtitle {
                    font-size: 24px;
                }
            }

            & .dwc-product-card-left-footer {
                display: flex;
                flex-direction: column;

                & .dwc-product-card-left-footer-stock {
                    font-size: 16px;
                    font-style: italic;
                }
                & .dwc-product-card-left-footer-price {
                    font-size: 32px;
                    font-style: italic;
                }
            }
        }

        & .demowelcomecard-product-card-right {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding-left: 16px;
            width: 75%;
            text-align: center;
            border-left: solid 1px #C6C6C6;
            transition: all 0.33s ease;

            & .dwc-product-card-right-image {
                display: flex;
                justify-content: center;
                align-items: center;
                width: 50%;
                height: auto;
            }
            & .dwc-product-card-right-description {
                border-top: solid 1px #C6C6C6;
                display: flex;
                justify-content: center;
                align-items: center;
                padding: 16px;
                font-size: 16px;
            }
        }

        &::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 2px;
            height: 100%;
            border-left: solid 2px #777777;
            transition: all 0.33s ease-in;
        }

        &:hover {
            background: rgba(198, 198, 198, 0.5);
            &::before {
                border-left-width: 6px;
            }
        }
        &:active {
            background: rgba(251,54,64, 0.25);
            &::before {
                border-left-width: 6px;
                border-left-color: #FB3640;
            }
        }
    }
}]]></res_file>
		<res_image/>
		<row_module_id.mdl_name>Demo</row_module_id.mdl_name>
	</data>
</object>
<object>
	<name>Resource</name>
	<action>upsert</action>
	<data>
		<res_object>
			<object>
				<name>ObjectExternal</name>
				<data>
					<obe_name>DemoWelcomeCard</obe_name>
				</data>
			</object>
		</res_object>
		<res_type>HTML</res_type>
		<res_lang>ANY</res_lang>
		<res_code>HTML</res_code>
		<res_cached>0</res_cached>
		<res_file><![CDATA[DATA:DemoWelcomeCard.html:<div id="demowelcomecard">
    <div id="demowelcomecard-header"></div>
    <div id="demowelcomecard-actions"></div>
    <div id="demowelcomecard-productlist"></div>
</div>
]]></res_file>
		<res_image/>
		<row_module_id.mdl_name>Demo</row_module_id.mdl_name>
	</data>
</object>
<object>
	<name>Resource</name>
	<action>upsert</action>
	<data>
		<res_object>
			<object>
				<name>ObjectExternal</name>
				<data>
					<obe_name>DemoWelcomeCard</obe_name>
				</data>
			</object>
		</res_object>
		<res_type>JS</res_type>
		<res_lang>ANY</res_lang>
		<res_code>CLASS</res_code>
		<res_cached>0</res_cached>
		<res_file><![CDATA[DATA:DemoWelcomeCard.js:Simplicite.UI.ExternalObjects.DemoWelcomeCard = class extends Simplicite.UI.ExternalObject {
    async render(params, data = {})
    {
        let app = $ui.getApp();
        let product = app.getBusinessObject("DemoProduct");
        let user = app.getBusinessObject("User");
        let login = $ui.getGrant().login;
        

        $("#demowelcomecard-header")
            .append($('<h1>').text("Welcome to Simplicit√©'s Demo !"))
            .append($('<h3>').text("We're excited to have you onboard. Explore, interact, and enjoy your experience with us !"));

        $("#demowelcomecard-actions")
            .append($('<button/>').text("Check the Tutorial").attr("id", "tutorial").addClass("demowelcomecard-btn").on("click", () => { window.open("https://docs.simplicite.io/", "_blank"); } ))
            .append($('<button/>').text("Display Products").attr("id","products").addClass("demowelcomecard-btn").on("click", () => {
            	console.log("HELLO MISTER USER");
            	let b = document.getElementById("demowelcomecard-productlist").hidden;
            	document.getElementById("demowelcomecard-productlist").hidden = !b;
            } ))
            .append($('<button/>').text("See my Infos").attr("id","user-infos").addClass("demowelcomecard-btn").on("click", () => {
            	user.search( function(){
					const usr = user.list.find(u => u.usr_login === login);
					
					if (usr && usr.row_id) {
						$ui.displayForm(null, "User", usr.row_id, {
							nav: "add",
							target: "work"
						});
					} else {
						console.error("User not found.");
					}
		        }, null, {});
            } ));
		
        product.search(function() {
            for (let i=0; i<product.count; i++)
            {
                const prd = product.list[i];
                const imageSource = `data:${prd.demoPrdPicture.mime};base64,${prd.demoPrdPicture.content}`;
                
                let productDiv = $('<div>').addClass("demowelcomecard-product-card").on("click", () => {
                	// triggers an error but still saves & runs ...
                	$ui.displayForm(null, "DemoProduct", prd.row_id, {
						nav: "add",
						target: "work"
					});
                });
   
                let cardLeft = $('<div>').addClass("dwc-product-card-left");
                
                let cardLeftHeader = $('<div>').addClass("dwc-product-card-left-header");
                let cardLeftHeaderTitle = $('<span>').addClass("dwc-product-card-left-header-title").text(prd.demoPrdName);
                let cardLeftHeaderSubtitle = $('<span>').addClass("dwc-product-card-left-header-subtitle").text(prd.demoPrdSupId__demoSupName+" - "+prd.demoPrdType);
                
                cardLeftHeader
                	.append(cardLeftHeaderTitle)
                	.append(cardLeftHeaderSubtitle);
                
                let cardLeftFooter = $('<div>').addClass("dwc-product-card-left-footer");
                let cardLeftFooterStock = $('<span>').addClass("dwc-product-card-left-footer-stock").text(prd.demoPrdStock+" left in stock.");
                let cardLeftFooterPrice = $('<span>').addClass("dwc-product-card-left-footer-price").text(prd.demoPrdUnitPrice+"‚Ç¨");
                
                cardLeftFooter
                	.append(cardLeftFooterStock)
                	.append(cardLeftFooterPrice);
                
                cardLeft
                	.append(cardLeftHeader)
                	.append(cardLeftFooter);
                
                let cardRight = $('<div>').addClass("demowelcomecard-product-card-right");
                
                let cardRightImage = $('<img/>').addClass("dwc-product-card-right-image").attr("src", imageSource).attr("alt", prd.demoPrdName);
                let cardRightText = $('<span>').addClass("dwc-product-card-right-description").text('"'+prd.demoPrdDescription+'"');
                
                
                cardRight
                	.append(cardRightImage)
                	.append(cardRightText);

                productDiv
                	.append(cardLeft)
                	.append(cardRight);
                
                $("#demowelcomecard-productlist").append(productDiv);
            }
            
            $("#demowelcomecard-productlist").attr("hidden", "true"); // hiding by default
            
        }, null, { inlineDocs: true });
	}
};]]></res_file>
		<res_image/>
		<row_module_id.mdl_name>Demo</row_module_id.mdl_name>
	</data>
</object>
<object>
	<name>TranslateExternal</name>
	<action>upsert</action>
	<data>
		<tsl_object>
			<object>
				<name>ObjectExternal</name>
				<data>
					<obe_name>DemoWelcomeCard</obe_name>
				</data>
			</object>
		</tsl_object>
		<tsl_lang>ENU</tsl_lang>
		<tsl_value>Welcome card</tsl_value>
		<tsl_plural_value/>
		<tsl_help/>
		<row_module_id.mdl_name>Demo</row_module_id.mdl_name>
	</data>
</object>
<object>
	<name>TranslateExternal</name>
	<action>upsert</action>
	<data>
		<tsl_object>
			<object>
				<name>ObjectExternal</name>
				<data>
					<obe_name>DemoWelcomeCard</obe_name>
				</data>
			</object>
		</tsl_object>
		<tsl_lang>FRA</tsl_lang>
		<tsl_value>Carte de Bienvenue</tsl_value>
		<tsl_plural_value/>
		<tsl_help/>
		<row_module_id.mdl_name>Demo</row_module_id.mdl_name>
	</data>
</object>
</simplicite>
