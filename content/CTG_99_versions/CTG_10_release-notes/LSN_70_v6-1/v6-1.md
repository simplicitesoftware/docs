Version 6.1 release note
========================

> **Note**: This release note corresponds to the current minor release.

Technical documentation <span id="doc"></span>
----------------------------------------------

All the technical documentation is available from the [plaform website](https://platform.simplicite.io), in particular:

- the [JavaDoc](https://platform.simplicite.io/6.1/javadoc/)
- the [JSDoc](https://platform.simplicite.io/6.1/jsdoc/)

Compatibility breaking changes <span id="compatbreakingchanges"></span>
-----------------------------------------------------------------------

- All deprecated methods from V3 and V4 have been removed
	- the legacy methods were already marked as deprecated in the logs a long time ago,
	- and had to be modified in V5.
	
- No more internal EJB support to access the database:
	- Nothing to do when Simplicité is deployed on Tomcat,
	- This feature is no more used since Simplicité V3 (transaction support with XA services),
	- The webapp connects the database thru a monitored connections pool (JDBC),
	- APIs use internal cache to guarantee high performance while optimizing memory.

- Removed wrapper for Rhino hooks implementation:
	- Rhino has been removed for hook implementation since V6.0
	- Classes `ScriptedObjectDB`, `ScriptedProcessus`, `ScriptedDisposition`, `ScriptedExternalObject` and `ScriptedPlatformHooks` has been removed from platform
	- if necessary to be easily replaced by their primary class: `ObjectDB`, `Processus`, `Disposition`, `ExternalObject` and `PlatformHooks`

- The 3rd party Unirest lib v3 has been upgraded to v4 (core) which means you will have to modify
  all the import statements in your java code from `kong.unirest.*` to `kong.unirest.core.*`.

Deprecated features to be removed in the next release 6.2 <span id="deprecation"></span>
----------------------------------------------------------------------------------------

- Deprecated `Bootstrap V4` rendering: please check if the UI runs already with `BOOTSTRAP_VERSION=5`
- Deprecated `Fullcalendar V3`: it is strongly recommended to use `FULLCALENDAR_VERSION=5`
- Deprecated `Cordova` hybrid app for mobile device is no more supported, engine only uses the responsive UI directly in a browser and the WebPush feature

Core changes <span id="changes"></span>
---------------------------------------

- A single permission supports multiple profiles/groups to factorize rights rules

- Added a new platform hook `customErrorResponse` to override, if needed, some case of error responses.
  Typical usage would be for external objects to generate custom error pages/data for authentication errors.

- Added various JSON schemas for validation of JSON/YAML settings, etc.

- Added `AuditTool.checkDeadLinks` to detect dead links in logs and generate a SQL patch thru audit tool:

![](dlaudit.png)
![](dlpatch.png)


UI changes <span id="uichanges"></span>
---------------------------------------

- Added support for declaring a custom monospace font on a theme.
  Note that theme-level fonts are now using dedicated CSS variables instead of a generated `font-family` styles:
	- `--simplicite-font` for the main font 
	- `--simplicite-font-mono` for the monospace font 

- Added new **experimental** custom HTML tags to ease usage of standard UI components within custom pages/widgets:

- New state-model navbar
	- The related list of values can have a rendering
	- Each status needs to specify its role: milestone, optional, exception or hidden
	- 3 styles exist (pure CSS):
		- breadcrumb / arrows / metro-line
		- with 3 options: step counter / visited date / user login
	- Visited steps are based on the history table
	- Current step, optional and exception roles can have their own style
	- Non visited milestones (from list of values) are displayed after the visited ones

Examples based on the demo:

![](lov.png)

breadcrumb with links

![](nav1.png)

![](nav2.png)

breadcrumb with arrows

![](nav_arrow.png)

metro line style

![](nav_metro.png)

metro line with 3 options: counter + user + date

![](nav_metro2.png)

- The `states-navbar` can be displayed anywhere on form with the template editor to edit options

![](naved1.png)

![](naved2.png)

- New dialog options:
	- `fullscreen`: to show the dialog in 100% of the container
	- `scrollable`: true by default to scroll the dialog body (false to scroll the page)
	
- `Field updatable` property is now a enum-multi to support the new option editable `by list cell`:

![](fld_upd.png)

Result:

![](list_upd.png)

- List template to display rows without common table/tr/td
	- Define a HTML template with mapped fields and actions
	- Applies to dedicated context (main list, panel, datamap or ref picker)
	- Associate the template to the `List template` of business object

![](list_tpl.png)

![](list_row.png)

Result:

![](list_rows.png)

- New hook `isFieldUpdatableByListCell`
	- to specify when a field is editable by cell
	- by default the method checks if the field is updatable as follow:

```java
/**
 * Checks if the field is updatable by list cell
 * @param f object field
 * @return true if the field can be changed in a list cell
 */
public boolean isFieldUpdatableByListCell(ObjectField f) {
	return f!=null
		&& f.isUpdatableByListCell() // Defined as updatable by cell ?
		&& !isReadOnly() // not a read only mode ?
		&& !isReadOnlyFields() // not a final status with read-only fields ?
		&& !getName().endsWith(Globals.HIST_SUFFIX); // not a history object
}
```

- New hook `isFieldUpdatableByListCell` example
  - the hook allows to limit some instances or user's profiles:

```java
public boolean isFieldUpdatableByListCell(ObjectField f) {
	return super.isFieldUpdatableByListCell(f) 
		&& isPanelInstance()
		&& getGrant().hasResponsibility("APP_MANAGER");
}
```

- Allows update on simple referenced fields (not userkey) thru the parent list or form
	- Set referenced field to be updatable in the object field definition
	- Saving parent will also save updated referenced objects
	
Example: set the Stock of Product updatable thru the Order (by form, edit list and/or cell)

![](updref.png)

The Stock will be updatable directly from one Order of the Product (within the form/list/cell):

![](updref2.png)

- Instance name of view's item has been updated to isolate concurrent access on same object within several sub-views

```
<home|panel>_ajax_<objectName>_<viewName>_<itemPosition>
ex: home_ajax_DemoOrder_DemoHome_2
```

### 6.1.0 release candidate 1 (2024-06-01) <span id="version-6.1.0-beta-RC1"></span>

- Initial release candidate for minor version 6.1. See above for details.

### 6.1.0 release candidate 2 (2024-06-24) <span id="version-6.1.0-beta-RC2"></span>

- Added parameter `CRON_LOCK_OWNER` to force only one node (endpoint URL) to get the `CRON_LOCK` (no ping/no failover when the parameter is set)
- Fixed label alignment in a search dialog on XS devise
- Allows edit-cell on list with group-by option

### 6.1.0 release candidate 3 (2024-07-01) <span id="version-6.1.0-beta-RC3"></span>

- Edit row template: inhib minified/grouped list to edit rows only
- Fixed import module in a JSON format with Dataset in XML format
- Fixed DataLink reset values on create
- Fixed front constraint with updatable rule on ENUM
- Allows templated list with group-by option in a sub-area
- Object summary body width forced to 100% 

### 6.1.0 release candidate 4 (2024-07-05) <span id="version-6.1.0-beta-RC4"></span>

- Added a DOM index to identify inputs between several edit lists on a same object
- Fixed on mismatch between objects' and processes' cache max size
- Added missing JSON schemas for widgets external objects' settings validation

### 6.1.0 release candidate 5 (2024-07-09) <span id="version-6.1.0-beta-RC5"></span>

- Fixed re-apply back constraints on save
- Logging improvements during system patches application
- Allows several edit-cell on a same field/same record between 2 lists on a same view

### 6.1.0 initial release (2024-07-10) <span id="version-6.1.0"></span>

- Initial release for minor version 6.0. See above for details.
- Fixed ENUM multiple rendering with SVG icons

### 6.1.1 (2024-07-25) <span id="version-6.1.1"></span>

- Added extra properties for Maven checkstyle plugin in module's `pom.xml`
- Removed platform-level items from the application-level information
- Added GPG signature support for Git commits, enabled by the `GIT_GPG_SIGNATURE_KEYID`
  system param which contains the GPG key ID (can be specified per-user)
- Fixed missing View fields on Module Export in JSON format
- Fixed export full on list into JSON format
- `JSONAdapter` & `YAMLAdapter` refactoring to support arrays of objects
  and same business logic except format conversion
- Added a `DEL_DENIED` message on non deletable rows during a `deleteAll`

### 6.1.2 (2024-08-05) <span id="version-6.1.2"></span>

- Added `java.net.ConnectException` in service SystemTool.ping
- Allows direct upgrade from Simplicite 5.3
- Fixed reset boolean filter on select activity of process
- Fixed front revision cache on URL to reload `TEXT` cache
- Fixed non public shortcuts loading when a single group Permission has no other permitted groups declared

### 6.1.3 (UNRELEASED) <span id="version-6.1.3"></span>

- Fixed hide the save button on a form reload when the isUpdateEnable becomes false
- Fixed textarea autosize on change event